<div class="page">

	<!-- Nav options -->
	<div class="nav-tabs-bar"></div>
	
	<div class='page-body'>
	<div>
		
		<div class="action-buttons" *ngIf="currentView == 'view-read'">
			<button class="btn btn-secondary arenella-btn" (click)="composeReply()"			*ngIf="currentEmail.sender.senderType === 'RECRUITER' || currentEmail.sender.senderType === 'CANDIDATE'">Reply</button>
			<button class="btn btn-secondary arenella-btn" (click)="markAsUnread()" 			*ngIf="currentEmail.viewed">Mark Unread</button>
			<button class="btn btn-secondary arenella-btn"  									*ngIf="!currentEmail.viewed" disabled>Mark Unread</button>
			<button class="btn btn-secondary arenella-btn" (click)="viewInbox()">Back</button>
		</div>
		
		<div *ngIf="hasEmails()">
			<table class="table email-table" *ngIf="currentView == 'view-inbox'">
				<thead>
					<tr>
						<th>From</th>
						<th>Subject</th>
						<th>Sent</th>
					</tr>
				</thead>
				<tr class="email_viewed_{{email.viewed}}" *ngFor="let email of emails" (click)="viewEmail(email)">
					<td>{{email.sender.senderName}}</td>
					<td>{{email.title}}</td>
					<td>{{email.created | date: 'dd MMM'}}</td>
				</tr>
			</table>
		</div>
		<div *ngIf="!hasEmails()" class="no-emails">
			<p>You currently have no emails.</p>
			<p>Email's are generated by the system, for example when a site visitor reacts to one of your posts on the job board.</p>
		</div>
	</div>
	<div *ngIf="currentView == 'view-read'">
		<div >
			<div class="email-title">{{currentEmail.title}}</div>
			<div class="email-header">
				<div class="left-div-header" *ngIf="currentEmail.sender.senderType === 'RECRUITER' || currentEmail.sender.senderType === 'CANDIDATE'">{{currentEmail.sender.senderName}}</div>
				<div class="left-div-header" *ngIf="currentEmail.sender.senderType != 'RECRUITER'">{{currentEmail.sender.senderName}} : {{currentEmail.sender.email}}</div>
				<div class="right-div-header">
					{{currentEmail.created | date: 'dd MMMM yyyy'}}
					<br>
					{{currentEmail.created | date: 'hh:mm:ss'}}
				</div>
			</div>
			<div class="attachments">
				<span class="attachment-title">Attachments:</span>
				<span *ngFor="let attachment of currentEmail.attachments">
					<a href="{{getAttachmentUrl(attachment, currentEmail)}}">
						<span class="attachment">{{attachment.name}}</span>
					</a>
				</span>
			</div>
			<div class="email-body">
				<div>
					<div class="left-div" style="white-space: pre-wrap;">{{currentEmail.body}}</div>
				</div>
				<div class="email-footer">
				</div>	
			</div>
			
		</div>
	</div>
	<div class="page-footer">
	</div>
	</div>
</div>

<!-- Reply Box -->
<dialog #replyBox>
	<div class="modal-header">
		<h4 class="modal-title">Send Reply</h4>
 		<div class="filter-close-box" (click)="replyBox.close()">X</div>
	</div>
	<div class="feedbackBox;">
		<div class="modal-body" *ngIf="replyState === 'compose'">
			<form [formGroup]="replyFormGroup">
				<textarea formControlName="message"></textarea>
			</form>
			<button class="btn btn-secondary arenella-btn" (click)="sendReply()">Send</button>
		</div>
		<div class="modal-body modal-feedback" *ngIf="replyState === 'success'">
			<p>The reply has been sent.</p>
		</div>
		<div class="modal-body modal-feedback" *ngIf="replyState === 'failure'">
			<p>Unfortunately it was not possible to send the reply at this time.</p>
		</div>
	</div>
</dialog>