<div class="page">

	<!-- Nav options -->
	<div class="nav-tabs-bar"></div>
		
	<div class="page-body">	
		
		<!-- Action buttons -->
		<div *ngIf="currentView === 'suggestion-results'" class="action-buttons">
			<button class="btn btn-secondary arenella-btn" (click)="showCreateAlertDialog()" download>{{'arenella-suggestions-btn-create-alert' | translate}}</button>
			<button class="btn btn-secondary arenella-btn" routerLink="/recruiter-alerts" download>{{'arenella-suggestions-btn-manage-alert' | translate}}</button>
	        <button class="btn btn-secondary arenella-btn" (click)="showSavedCandidates()" download>{{'arenella-suggestions-btn-my-candidates' | translate}}</button>
	        <button class="btn btn-secondary arenella-btn" (click)="openPublicityDialog()" *ngIf="isAuthenticatedAsAdmin()" download>{{'arenella-suggestions-btn-copy' | translate}}</button>
	        <button class="btn btn-secondary arenella-btn" (click)="showFilterByJobSpecDialog(specUploadBox)" download>{{'arenella-suggestions-btn-filter-by-spec' | translate}}</button>
	        <button class="btn btn-secondary arenella-btn" (click)="doReset()">{{'arenella-suggestions-btn-reset' | translate}}</button>
	     </div>
		
		<div *ngIf="currentView === 'saved-candidates'">
			<app-saved-candidates [savedCandidates]="savedCandidates" (switchViewEvent)="showSuggestionsResults()" [infoItemConfig]="infoItemConfig" [skillFilters]="skillFilters"></app-saved-candidates>
		</div>
	
		<div>	
			<form [formGroup]="suggestionFilterForm" *ngIf="currentView === 'suggestion-results'">	
			
				<div *ngIf="currentView === 'suggestion-results'">		
					<table class="mobile-search-box">
						<tr>
							<td class="sugg-srch-hdr">{{'arenella-suggestions-job-title' | translate}}</td>
							<td class="sugg-srch-bdy">
								<input type="text" value="Java Developer" class="sugg-srch-job-title" formControlName="searchPhrase">
							</td>
						</tr>
						<tr>
							<td class="sugg-srch-hdr">{{'arenella-suggestions-geoZones' | translate}}</td>
							<td *ngIf="!showGeoZoneFilters">
								<p class="toggle-filter-option" (click)="switchGeoZoneFilterView('showGeoZoneFilters')">{{'Show' | translate}}..</p>
							</td>
							<td *ngIf="showGeoZoneFilters" class="sugg-srch-bdy geo-zone-filters">
								<p class="toggle-filter-option" (click)="switchGeoZoneFilterView('')">{{'Hide' | translate}}..</p>
								<div *ngFor="let geoZone of geoZones" class="geo-code-filter geo-code-selected-{{includeResultsForGeoZone(geoZone)}}" (click)="toggleGeoZoneSelection(geoZone)">
									{{geoZone.geoZoneId | translate}}
								</div>
								
							</td>
						</tr>
						<tr>
							<td class="sugg-srch-hdr">{{'arenella-suggestions-country' | translate}}</td>
							<td *ngIf="!showCountryFilters">
								<p class="toggle-filter-option" (click)="switchCountriesFilterView('showCountryFilters')">{{'Show' | translate}}..</p>
							</td>
							<td *ngIf="showCountryFilters" class="sugg-srch-bdy country-filters">
								<p class="toggle-filter-option" (click)="switchCountriesFilterView('')">{{'Hide' | translate}}..</p>
								<div class="country-selections">
									<span *ngFor="let supportedCountry of supportedCountries" class="country-filter country-selected-{{includeResultsForCountry(supportedCountry.iso2Code)}}" (click)="toggleCountrySelection(supportedCountry.iso2Code)">
										<mat-icon title="{{supportedCountry.name}}">
											<span class="flag-icon flag-icon-{{supportedCountry.iso2Code}} flag-icon-med"></span>
										</mat-icon>
									</span>
								</div>
							</td>
						</tr>
					
						<tr>
							<td class="sugg-srch-hdr">{{'arenella-suggestions-contract' | translate}}</td>
							<td class="sugg-srch-bdy">
								<select class="contract-type" formControlName="contractType">
									<option value="BOTH">{{'arenella-suggestions-both' | translate}}</option>
									<option value="CONTRACT">{{'arenella-suggestions-contract' | translate}}</option>
									<option value="PERM">{{'arenella-suggestions-permanent' | translate}}</option>
								</select>
							</td>
						</tr>
						<tr>
							<td class="sugg-srch-hdr">{{'arenella-suggestions-language' | translate}}</td>
							<td *ngIf="!showLanguageFilters">
								<p class="toggle-filter-option" (click)="switchLanguageFilterView('showLanguageFilters')">{{'Show' | translate}}..</p>
							</td>
							<td class="sugg-srch-bdy" *ngIf="showLanguageFilters">
								<p class="toggle-filter-option" (click)="switchLanguageFilterView('')">{{'Hide' | translate}}..</p>
								<ul class="sugg-srch-ctry-ul">
									<li class="sugg-srch-ctry-chkbox" *ngFor="let lang of supportedLanguages"><input type="checkbox" [formControlName]="lang.languageCode.toLowerCase()+'Language'" class="lang-checkbox">{{'arenella-suggestions-' + lang.languageCode.toLowerCase() | translate}}</li>
								</ul>					
							</td>
						</tr>
					
						<tr>
							<td class="sugg-srch-hdr">{{'arenella-suggestions-experience' | translate}}</td>
							<td class="sugg-srch-bdy">
								<div>
									<select class="min" formControlName="minYearsExperience">
										<option *ngFor="let opt of minMaxOptions" value="{{opt}}">{{opt}}</option>
									</select>
									<span> <B>{{'arenella-suggestions-to' | translate}}</B> </span>
									<select class="max" formControlName="maxYearsExperience">
										<option *ngFor="let opt of minMaxOptions" value="{{opt}}">{{opt}}</option>
									</select>
								</div>
							</td>
						</tr>
						 
						<tr>
							<td class="sugg-srch-hdr">{{'arenella-suggestions-include' | translate}}</td>
							<td *ngIf="!showIncludeFilters">
								<p class="toggle-filter-option" (click)="switchIncludeFilterView('showIncludeFilters')">{{'Show' | translate}}..</p>
							</td>
							<div *ngIf="showIncludeFilters">
								<p class="toggle-filter-option" (click)="switchIncludeFilterView('')">{{'Hide' | translate}}..</p>
								<div class="geo-code-filter geo-code-selected-{{includeUnavailableCandidatesSelected}}" (click)="doPaidSubscriptionCheckUnavailableCandidates()" *ngIf="isAdmin() || hasPaidSubscription()">
									{{'arenella-suggestions-include-unavailable-candidates' | translate}}
								</div>
								<div class="geo-code-filter geo-code-selected-{{includeRequiresSponsorshipCandidatesSelected}}" (click)="doPaidSubscriptionCheckRequiresSponsorshipCandidates()">
									{{'arenella-suggestions-include-requires-sponsorship-candidates' | translate}}
								</div>
							</div>
						</tr>
						<tr>
							<td class="sugg-srch-hdr">{{'arenella-suggestions-skills' | translate}}</td>
							<td class="sugg-srch-bdy">
								<form [formGroup]="skilFilterForm">
									<input class="skill-field" type="text" formControlName="skill"><button (click)="addSkill()" class="btnX btn-secondary add-skill-btn">{{'arenella-suggestions-add' | translate}}</button>
								</form>
							</td>
						</tr>
						<tr>
							<td colspan="2">
								<div style="min-height:40px;">
									<div class="selected-skill" *ngFor="let skill of skillFilters" (click)="removeSkill(skill)">{{skill}}</div>
								</div>
							</td>
						</tr>
					
					</table>
				</div>
			</form>
		</div>
	
		<!-- Suggestion Results -->
		<div *ngIf="currentView === 'suggestion-results'">
		
			<div class="suggestion-result-icons">
			
				<div class="suggestion-icon {{suggestionMobileClass}} {{getUnvailableCssClass(suggestion)}}" *ngFor="let suggestion of suggestions" (click)="showSuggestedCandidateOverview(suggestion)">
					<div>
						
						<div *ngIf="!isSavedCandidate(suggestion)" class="suggestion-icon-header">	
						<span class=" flag-icon {{getFlagClassFromCountry(suggestion.country)}} suggestion-results-flag-country"></span> <span class="candidate-id"> C{{suggestion.candidateId}}</span>
						</div>
						<div *ngIf="isSavedCandidate(suggestion)" class="suggestion-icon-header suggestion-icon-header-saved">	
						<span class=" flag-icon {{getFlagClassFromCountry(suggestion.country)}} suggestion-results-flag-country"></span> <span class="candidate-id"> C{{suggestion.candidateId}}</span>
						</div>
					</div>
					<div title="Accuracy Skills" class="suggestion-perception-result-{{suggestion.accuracySkills}}"></div>
					<div title="Accuracy Languages" class="suggestion-perception-result-{{suggestion.accuracyLanguages}}"></div>
					<div class="suggestion-icon-body">
						<div>
							{{suggestion.firstname}} {{suggestion.surname}}
						</div>
						<div>
							{{suggestion.roleSought}}
						</div>
					</div>
				</div>
				
			</div>
			<div class="suggestion-result-footer">&nbsp;</div>
		</div>

		<!-- Suggestion Profile -->
		<div *ngIf="currentView === 'suggested-canidate-overview'">
			<app-candidate-profile (backEvent)="showSuggestionsResults()" [parentComponent]="parentComponent" [isViewOnly]="isViewOnly()" [infoItemConfig]="infoItemConfig" [suggestedCandidate]="suggestedCandidate" [candidateProfile]="candidateProfile" [skillFilters]="skillFilters"></app-candidate-profile>
		</div>
	</div>
</div>

<dialog #specUploadBox>
	<div class="modal-header">
		<h4 class="modal-title">{{'arenella-suggestions-box-spec-hdr' | translate}}</h4>
 		<div class="filter-close-box" (click)="specUploadBox.close()">X</div>
	</div>
	<div class="specUploadBox;">
		<div class="modal-body" *ngIf="showFilterByJobSpec && jobSpecUploadView == 'chooseType'">
			<p>{{'arenella-suggestions-box-spec-intro' | translate}}</p>
			<div class="job-spec-options">
			<div class="job-spec-upld-opt" (click)="switchJobSpecUpldOpt('doc')">{{'arenella-suggestions-box-spec-file' | translate}}</div>
			<div class="job-spec-upld-opt" (click)="switchJobSpecUpldOpt('text')">{{'arenella-suggestions-box-spec-text' | translate}}</div>
			</div>
		</div>
		<div class="modal-body" *ngIf="showFilterByJobSpec && jobSpecUploadView == 'doc'">
			<input type="file" (change)="setJobSepecFile($event)">
			<br><br>
				<button class="btn btn-secondary" (click)="extractFiltersFromJobSpec()">{{'arenella-suggestions-box-spec-extraction' | translate}}</button>
			<br><br>
			<p>{{'arenella-suggestions-box-spec-file-types' | translate}}</p>
			<br><br>
		</div>
		<div class="modal-body" *ngIf="showFilterByJobSpec && jobSpecUploadView == 'text'">
			<form [formGroup]="filterByJobSpecForm">
				<textarea formControlName="specAsText" (click)="clearSpecAsText()">
					
				</textarea>
				<br><br>
					<button class="btn btn-secondary" (click)="extractFiltersFromJobSpecText()">{{'arenella-suggestions-box-spec-extraction' | translate}}</button>
				<br><br>
				<br><br>
			</form>
		</div>
		<div class="modal-body" *ngIf="showFilterByJonSpecFailure">
			<p>{{'arenella-suggestions-box-spec-msg-failure' | translate}}</p>
		</div>
	</div>
</dialog> 

<dialog #feedbackBox >
	<div class="modal-header">
		<h4 class="modal-title">{{'arenella-suggestions-box-alert-hdr' | translate}}</h4>
 		<div class="filter-close-box" (click)="feedbackBox.close()">X</div>
	</div>
	<div class="feedbackBox;">
		<form [formGroup]="createAlertForm">
			<div class="modal-body" *ngIf="showSaveAlertBox">
				<p class="info-text">{{'arenella-suggestions-box-alert-text' | translate}}</p>
				{{'arenella-suggestions-box-alert-name' | translate}}: <input type="text" formControlName="alertName">
				<br/><br/>
				<button class="btn btn-secondary" (click)="saveAlert()" download>{{'arenella-suggestions-box-alert-btn-save' | translate}}</button>
			</div>       
			<div class="modal-body" *ngIf="showSaveAlertBoxSuccess">
				<p>{{'arenella-suggestions-box-alert-success-1' | translate}}</p>
				<p>{{'arenella-suggestions-box-alert-success-2' | translate}}</p>
			</div>
			<div class="modal-body" *ngIf="showSaveAlertBoxFailure">
				<p>{{'arenella-suggestions-box-alert-failure' | translate}}</p>
			</div>
		</form>
	</div>
</dialog>
<!-- publicity -->
<dialog #publicityModal>

	<!--  Options -->
	<div class="modal-header">
		<h4 class="modal-title">{{'arenella-suggestions-box-publicity-hdr' | translate}}</h4>
		<div class="filter-close-box" (click)="publicityModal.close()">X</div>
	</div>
	<div class="modal-body publicity-suggestions">
		<table>
			<div *ngFor="let c of publicitySuggestions">
				{{getCountryCode(c.country)}} - {{'arenella-suggestions-box-publicity-exp' | translate}}: {{c.yearsExperience}}  {{'arenella-suggestions-box-publicity-years' | translate}} -  {{c.roleSought}}
			</div>
		</table>
	</div> 
</dialog>
<!-- Paid subscription only -->
<dialog #paidSubscriptionModal>

	<!--  Options -->
	<div class="modal-header">
		<h4 class="modal-title">{{'arenella-suggestions-paid-subscription-option' | translate}}</h4>
		<div class="filter-close-box" (click)="paidSubscriptionModal.close()">X</div>
	</div>
	<div class="modal-body">
		<p>{{'arenella-suggestions-paid-subscription-text-1' | translate}}</p>
		<p *ngIf="paidFeature == 'paidFeatureUnavailableCandidates'">{{'arenella-suggestions-paid-subscription-text-3' | translate}} : {{candidateTotals.unavailable}}</p>
		<p *ngIf="paidFeature == 'paidFeatureGeoZones'">{{'arenella-suggestions-paid-subscription-text-2-geozone' | translate}}</p>
		<p>{{'arenella-suggestions-paid-subscription-text-2' | translate}}</p>
		<button class="btn btn-secondary" (click)="choseSubscription()" download>{{'arenella-suggestions-paid-subscription-choose-subscription-btn' | translate}}</button>
	</div> 
</dialog>
