<div class=".container m-2">

	<!-- Action buttons -->
	<div *ngIf="currentView === 'suggestion-results'">
		<button class="btn btn-secondary btnRight main-btns" (click)="doReset()">Reset</button>
		<button class="btn btn-secondary btnRight main-btns" (click)="showFilterByJobSpecDialog(specUploadBox)" download>Filter by Job Spec</button>
		<button class="btn btn-secondary btnRight main-btns" (click)="showCreateAlertDialog(feedbackBox)" download>Create Email Alert</button>
		<button class="btn btn-secondary btnRight main-btns" (click)="showSavedCandidates()" download>Your Candidates</button>
	 </div>
	 
	
	<div *ngIf="currentView === 'saved-candidates'" class="suggestion-results">
		
		<div style="text-align:right;margin-right:50px;">
			<button class="btn btn-secondary btn-action" (click)="showSuggestionsResults()">back</button>
		</div>
	 
		<div class="suggestion-result-icons" style="margin-top:50px">
			
			<div class="suggestion-icon" *ngFor="let suggestion of suggestions" (click)="showSuggestedCandidateOverview(suggestion)">
				
				<div class="suggestion-icon-header">
					C{{suggestion.candidateId}}
				</div>
				<div title="Accuracy Skills" class="suggestion-perception-result-{{suggestion.accuracySkills}}"></div>
				<div title="Accuracy Languages" class="suggestion-perception-result-{{suggestion.accuracyLanguages}}"></div>
				<div class="suggestion-icon-body">
					<div>
						{{suggestion.firstname}} {{suggestion.surname}}
					</div>
					<div>
						{{suggestion.roleSought}}
					</div>
				</div>
				
			</div>
				
		</div>
		<div style="height:20px;width:300px;">&nbsp;</div>
	</div>
	
	<div>	
		<form [formGroup]="suggestionFilterForm" *ngIf="currentView === 'suggestion-results'">
	
			<div class="left-menu" *ngIf="currentView === 'suggestion-results'">		
				<table style="width:80%;">
					<tr>
						<td class="sugg-srch-hdr">Job Title</td>
						<td class="sugg-srch-bdy">
							<input type="text" value="Java Developer" class="sugg-srch-job-title" formControlName="searchPhrase">
							
						</td>
						
					</tr>
					
					<tr>
						<td class="sugg-srch-hdr">Country</td>
						<td class="sugg-srch-bdy country-filters">
							<span class="country-filter country-selected-{{includeResultsForCountry('nl')}}" (click)="toggleCountrySelection('nl')">
								<span class="flag-icon flag-icon-nl flag-icon-med"></span>
							</span>
							<span class="country-filter country-selected-{{includeResultsForCountry('be')}}" (click)="toggleCountrySelection('be')">
								<span class="flag-icon flag-icon-be flag-icon-med"></span>
							</span>
							<span class="country-filter country-selected-{{includeResultsForCountry('uk')}}" (click)="toggleCountrySelection('uk')">
								<span class="flag-icon flag-icon-gb flag-icon-med"></span>
							</span>
							<span class="country-filter country-selected-{{includeResultsForCountry('ie')}}" (click)="toggleCountrySelection('ie')">
								<span class="flag-icon flag-icon-ie flag-icon-med"></span>
							</span>
						</td>
					</tr>
					
					<tr>
						<td class="sugg-srch-hdr">Contract</td>
						<td class="sugg-srch-bdy">
							<select class="contract-type" formControlName="contractType">
							<option value="BOTH">Both (Includes unknown)</option>
							<option value="CONTRACT">Contract</option>
							<option value="PERM">Permanent</option>
						</select>
						</td>
					</tr>
					<tr>
						<td class="sugg-srch-hdr">Languages</td>
						<td class="sugg-srch-bdy">
							<ul class="sugg-srch-ctry-ul">
								<li class="sugg-srch-ctry-chkbox"><input type="checkbox" formControlName="dutchLanguage" class="lang-checkbox">Dutch</li>
								<li class="sugg-srch-ctry-chkbox"><input type="checkbox" formControlName="frenchLanguage" class="lang-checkbox">French</li>
								<li class="sugg-srch-ctry-chkbox"><input type="checkbox" formControlName="englishLanguage" class="lang-checkbox">English</li>
							</ul>					
						</td>
					</tr>
					
					<tr>
						<td class="sugg-srch-hdr">Years Exp</td>
						<td class="sugg-srch-bdy">
							<div style="margin-top:10px;">
								<select class="min" formControlName="minYearsExperience">
									<option *ngFor="let opt of minMaxOptions" value="{{opt}}">{{opt}}</option>
								</select>
								<span> <B>TO</B> </span>
								<select class="max" formControlName="maxYearsExperience">
									<option *ngFor="let opt of minMaxOptions" value="{{opt}}">{{opt}}</option>
								</select>
							</div>
						</td>
					</tr>
					
					<tr>
						<td class="sugg-srch-hdr">Skills</td>
						<td class="sugg-srch-bdy">
							<input class="skill-field" type="text" formControlName="skill"><button (click)="addSkill()" class="btnX btn-secondary add-skill-btn">Add</button>
						</td>
					</tr>
					<tr>
						<td colspan="2">
							<div style="min-height:35px;">
								<div class="selected-skill" *ngFor="let skill of skillFilters" (click)="removeSkill(skill)">{{skill}}</div>
							</div>
						</td>
					</tr>
					
				</table>
			</div>
		</form>
	</div>
	
	<!-- Inline CV -->
	<div *ngIf="currentView === 'inline-cv'">
	
		<div style="text-align:right;margin-right:50px;">
			<button class="btn btn-secondary btn-action" (click)="showSuggestedCandidateOverview(suggestedCandidate)">back</button>
		</div>
		
		<object id="content"  class="cv-inline" [attr.data]="trustedResourceUrl" width="95%" height="500px">
			
		</object>
	
	</div>
	
	<!-- Suggestion Results -->
	<div *ngIf="currentView === 'suggestion-results'" class="suggestion-results">
		
		<div class="suggestion-result-icons">
			
			<div class="suggestion-icon" *ngFor="let suggestion of suggestions" (click)="showSuggestedCandidateOverview(suggestion)">
				
				<div class="suggestion-icon-header">
					C{{suggestion.candidateId}}
				</div>
				<div title="Accuracy Skills" class="suggestion-perception-result-{{suggestion.accuracySkills}}"></div>
				<div title="Accuracy Languages" class="suggestion-perception-result-{{suggestion.accuracyLanguages}}"></div>
				<div class="suggestion-icon-body">
					<div>
						{{suggestion.firstname}} {{suggestion.surname}}
					</div>
					<div>
						{{suggestion.roleSought}}
					</div>
				</div>
				
			</div>
				
		</div>
		<div style="height:20px;width:300px;">&nbsp;</div>
	</div>

	<!-- Suggestion Profile -->
	<div style="margin-top:10px;" *ngIf="currentView !== 'suggestion-results' && currentView !== 'inline-cv' && currentView !== 'saved-candidates'">
		<div class="suggestion-buttons">
			<a class="currliculum-link" href="{{getCurriculumDownloadUrl(suggestedCandidate.candidateId)}}" >
				<button class="btn btn-secondary btn-action">Download CV</button>
			</a>
			<button class="btn btn-secondary btn-action" (click)="showInlineCVView()" 						*ngIf="!isMobile">Display CV</button>
			<button class="btn btn-secondary btn-action" (click)="rememberCandidate(suggestedCandidate)" 	*ngIf="lastView != 'saved-candidates'" alt="Add candidate to your list of selected candidates">Save Candidate</button>
			<button class="btn btn-secondary btn-action" (click)="showSuggestionsResults()" 				*ngIf="lastView != 'saved-candidates'">back</button>
			<button class="btn btn-secondary btn-action" (click)="showSavedCandidates()" 					*ngIf="lastView === 'saved-candidates'">back</button>
		</div>
	</div>
	<div *ngIf="currentView === 'suggested-canidate-overview'" class="suggestion-results" style="width:90%;">
		 		
		<div>
		
			<h1 class="suggestion-role-header">{{suggestedCandidate.roleSought}}</h1>
			
			<div>
				<table class="table candidate-suggestion-table">
					<tr>
						<td class="candidate-suggestion-table-hdr">Canidate Number</td>
						<td>{{suggestedCandidate.candidateId}}</td>
					</tr>
					<tr>
						<td class="candidate-suggestion-table-hdr">Name</td>
						<td>{{suggestedCandidate.firstname}} {{suggestedCandidate.surname}}</td>
					</tr>
					<tr>
						<td class="candidate-suggestion-table-hdr">Location</td>
						<td *ngIf="suggestedCandidate.country === 'NETHERLANDS'">
							<span class="flag-icon flag-icon-nl suggestion-flag-country"></span>
							{{suggestedCandidate.city}}
						</td>
						<td *ngIf="suggestedCandidate.country === 'BELGIUM'">
							<span class="flag-icon flag-icon-be  suggestion-flag-country"></span>
							{{suggestedCandidate.city}}
						</td>
						<td *ngIf="suggestedCandidate.country === 'UK'">
							<span class="flag-icon flag-icon-gb  suggestion-flag-country"></span>
							{{suggestedCandidate.city}}
						</td>
						<td *ngIf="suggestedCandidate.country === 'REPUBLIC_OF_IRELAND'">
							<span class="flag-icon flag-icon-ie  suggestion-flag-country"></span>
							{{suggestedCandidate.city}}
						</td>
						
					</tr>
					<tr>
						<td class="candidate-suggestion-table-hdr">Years Experience</td>
						<td>{{suggestedCandidate.yearsExperience}}</td>
					</tr>
					<tr>
						<td class="candidate-suggestion-table-hdr">Contract Type</td>
						<td>
							<div class="suggestion-summary-infobox-body">
								
								<span>Contract</span>
								<span class="skill-level">
									<span *ngIf="suggestedCandidate.freelance == 'TRUE'" class="material-icons available-check-icon">
			      						check
			      					</span>
			      				</span>
			      				
			      				<span>Permanent</span>
			      				<span class="skill-level">
			      					<span *ngIf="suggestedCandidate.perm == 'TRUE'" class="material-icons available-check-icon">
				      					check
				      				</span>
			      				</span>
			      				
		      				</div>
						</td>
						
					</tr>
					<tr>
						<td class="candidate-suggestion-table-hdr">Languages</td>
						<td>
							<div  class="suggestion-summary-infobox-body" *ngFor="let language of suggestedCandidate.languages">
								<span>{{getLanguage(language.language)}}</span>
								<span class="language-level">
									<span *ngIf="language.level == 'PROFICIENT'" class="material-icons lang-proficient-check-icon">
      									check
      								</span>
     								<span *ngIf="language.level == 'BASIC'" class="material-icons  lang-basic-check-icon">
      									check
      								</span>
     							</span>
							</div>
						</td>
					</tr>
					<tr>
						<td class="candidate-suggestion-table-hdr">Skill Accuracy</td>
						<td>
							<div class="suggestion-perception-{{suggestedCandidate.accuracySkills}}"></div>
						</td>
					</tr>
					<tr>
						<td class="candidate-suggestion-table-hdr">Language Accuracy</td>
						<td>
							<div class="suggestion-perception-{{suggestedCandidate.accuracyLanguages}}"></div>
						</td>
					</tr>
					<tr>
						<td class="candidate-suggestion-table-hdr">Matching Skills</td>
						<td>
							<div style="float:center" *ngFor="let skill of skillFilters" class="{{hasRequiredSkill(skill)}}">
								{{skill}}
							</div>
						</td>
					</tr>
				</table>
			</div>
							
		</div>
	</div>
</div>

<ng-template #specUploadBox let-modal>
	<div class="modal-header">
		<h4 class="modal-title">Extract Filters from Job Specification</h4>
 		<div class="filter-close-box" (click)="closeModal()">X</div>
	</div>
	<div class="feedbackBox;">
		<div class="modal-body" *ngIf="showFilterByJobSpec">
			<input type="file" (change)="setJobSepecFile($event)">
			<br><br>
				<button class="btn btn-secondary" (click)="extractFiltersFromJobSpec()">Perform Extraction</button>
			<br><br>
			<p>File types of .doc, .docx and pdf up to 1MB</p>
			<br><br>
		</div>
		<div class="modal-body" *ngIf="showFilterByJonSpecFailure">
			<p>Unfortunately it was not possible to extract filters from this file.</p>
		</div>
	</div>
</ng-template> 

<ng-template #feedbackBox let-modal>
	<div class="modal-header">
		<h4 class="modal-title">Create Email Alert</h4>
 		<div class="filter-close-box" (click)="closeModal()">X</div>
	</div>
	<div class="feedbackBox;">
		<form [formGroup]="createAlertForm">
			<div class="modal-body" *ngIf="showSaveAlertBox">
				<p class="info-text">Please add required filters before creating your alert</p>
				Alert Name: <input type="text" formControlName="alertName">
				<br/><br/>
				<button class="btn btn-secondary" (click)="saveAlert()" download>Save</button>
			</div>       
			<div class="modal-body" *ngIf="showSaveAlertBoxSuccess">
				<p>Your Candidate Search Alert was created successfully. You will now receive alerts when matching candidates are uploaded.</p>
				<p>You can manage alerts in the 'Manage Search Alerts' screen.</p>
			</div>
			<div class="modal-body" *ngIf="showSaveAlertBoxFailure">
				<p>Unfortunately it was not possible to create your Candidate Search Alert at this time.</p>
			</div>
		</form>
	</div>
</ng-template>